\documentclass[12pt,oneside]{../../sfsuthesis} 
 
\RequirePackage{standalone}
\usepackage[draft]{../../MAThesisOutputFormat}
\input{../../preamble.tex}
\usepackage[backend=biber,style=numeric]{biblatex}
\addbibresource{../../thesis.bib}

\begin{document}

\chapter{A Proof of the Heron-Rota-Welsh Conjecture}

We have now all of our dominoes lined up, and we're just about ready to start knocking them down.
The bulk of this section will go to proving that Bergman fans are AF\@.
Once we have that, the Heron-Rota-Welsh conjecture is easily in sight, just requiring us to address a few lingering points.
Then, working our way back from the realm of geometry we follow a quick series of implications back to matroids and the the characteristic polynomial.

\section{Stars and the Products of Minors}

Before we can prove that Bergman fans are AF, we would like to establish a relationship between the stars of fans of matroids and the fans of that matroid's minors.
We are going to show that there is an isomorphism between star fans of a matroid and the product of fans of the minors.
This will let us use knowledge of matroids in proving facts about stars, rather than treating them as purely geometric objects.
To get there we need the first ingredient of a fan isomorphism, a linear map.
\begin{lemma}\th\label{thm:quotientBijection}
    Let \( \bSigma_\cM \subset \bN_E \) be the Bergman fan of a matroid,
    \[
        \scrF = \{ F_1 \subsetneq F_2 \subsetneq \cdots \subsetneq F_k \} \subseteq \cL^\ast
    \]
    be a flag of flats, and define \( F_0 = \emptyset \) and \( F_{k+1} = E \).
    The map
    \begin{gather*}
        \varphi:\, \bN_E / \Span(\sigma_{\scrF}) \to \bigoplus_{i=1}^{k+1} \bN_{F_i \setminus F_{i-1}} \\
        [e_I] \mapsto \bigoplus_{i=1}^{k+1} e_{I \cap (F_i \setminus F_{i-1})}
    \end{gather*}
    is a linear isomorphism.
\end{lemma}
\begin{proof}
    Consider the very similar map
    \begin{gather*}
        \varphi':\, \bN_E \to \bigoplus_{i=1}^{k+1} \bN_{F_i \setminus F_{i-1}} \\
        e_I \mapsto \bigoplus_{i=1}^{k+1} e_{I \cap (F_i \setminus F_{i-1})}.
    \end{gather*}
    We will show \( \varphi' \) is a surjective linear map and that its kernel is exactly \( \Span(\sigma_\scrF)  \).
    With that, we can leverage the first isomorphism theorem, which will give us that \( \varphi \) is an isomorphism.

    Our map is linear by its definition, so let's first show that it is surjective.
    Consider some vector \( w \in  \bigoplus_{i=1}^{k+1} \bN_{F_i \setminus F_{i-1}}\) of the form
    \[
        w = \bigoplus_{i=1}^{k+1} \left( \sum_{j \in (F_i \setminus F_{i-1} )} \lambda_j e_j \right).
    \]
    Then \( w \) is a linear combination of the elements in some \( F_i \setminus F_{i-1} \).
    This of course is the image of the vector
    \[
        v = \sum_{i=1}^{k+1} \left( \sum_{j \in (F_i \setminus F_{i-1} )} \lambda_j e_j \right) \in \bN_E,
    \]
    and so we have surjectivity.

    Next we want to show that any element in \( \Span(\sigma_\scrF) \) is in the kernel.
    From construction, anything in \( \Span( e_{F_i \setminus F_{i-1}}) \) is sent to 0 in \( \bN_{F_i \setminus F_{i-1}} \), in particular \( e_{F_i \setminus F_{i-1}} \) itself.
    Given some \( v \in \Span( \sigma_\scrF ) \) of the form
    \[
        v = \lambda_1 e_{F_1} + \lambda_2 e_{F_2} + \cdots + \lambda_k e_{F_k},
    \]
    we have
    \begin{align*}
        \phi'(v) & = \lambda_1 \phi'(e_{F_1}) + \lambda_2 \phi'(e_{F_2}) + \cdots + \lambda_k \phi'(e_{F_k})                                                                                                                                                 \\
                 & = \lambda_1 \left(e_{F_1}\right) + \lambda_2 \left(e_{F_1} \oplus  e_{F_2 \setminus F_1}\right) + \cdots + \lambda_k \left(e_{F_1} \oplus \lambda_k e_{F_2 \setminus F_1} \oplus \cdots \oplus \lambda_k e_{F_k \setminus F_{k-1}}\right) \\
                 & = (\lambda_1 + \lambda_2 + \cdots + \lambda_k) e_{F_1} \oplus (\lambda_2 + \lambda_3 + \cdots + \lambda_k) e_{F_2 \setminus F_1} \oplus \cdots \oplus \lambda_k e_{F_k \setminus F_{k-1}}                                                 \\
                 & = (\lambda_1 + \lambda_2 + \cdots + \lambda_k) 0 \oplus (\lambda_2 + \lambda_3 + \cdots + \lambda_k) 0 \oplus \cdots \oplus \lambda_k 0                                                                                                   \\
                 & = 0
    \end{align*}
    showing that \( \Span(\sigma_\scrF) \subseteq \ker(\phi') \).

    Now we just need to count some dimensions.
    By definition, \( \dim(\bN_E) = | E | - 1 \).
    Likewise, each \( \bN_{F_i \setminus F_{i-1}} \) has dimension \( | F_i \setminus F_{i-1} | - 1 \).
    This gives us
    \begin{align*}
        \dim\left( \bigoplus_{i=1}^{k+1} \bN_{F_i \setminus F_{i-1}} \right) & = \sum_{i=1}^{k+1} | F_i \setminus F_{i-1} | - 1                    \\
                                                                             & = \left(\sum_{i=1}^{k+1} | F_i \setminus F_{i-1} |\right) - (k + 1) \\
                                                                             & = | E | - (k + 1),
    \end{align*}
    as \( \{  F_i \setminus F_{i-1} \}_{i=1}^{k+1} \) is just a partition of \( E \).
    Since \( \phi' \) is surjective, this means
    \[
        \dim\big(\im(\phi')\big) = | E | - (k + 1)
    \]
    as well.
    We have that \( \scrF \) is a flag of \( k \) flats, so \( \dim(\sigma_\scrF) = k \), which thanks to the inclusion we found above means \( \dim\big(\ker(\phi')\big) \geq k \).
    But by the rank-nullity theorem
    \begin{align*}
        \dim\big(\ker(\phi')) & = \dim(\bN_E) - \dim\big( \im(\phi') \big)  \\
                              & = | E | - 1 - \left( | E | - (k + 1)\right) \\
                              & = k
    \end{align*}
    giving us that \( \ker(\phi') \) is exactly \( \Span(\sigma_\scrF) \).
    With that we have
    \[
        \bN_E/ \Span(\sigma_{\scrF}) \cong \bigoplus_{i=1}^{k+1} \bN_{F_i \setminus F_{i-1}}
    \]
    by the first isomorphism theorem and that our map \( \phi \) is the given isomorphism between these spaces.
\end{proof}

With an isomorphism between these two spaces in hand, we can show that the stars of a matroid's Bergman fan have a local structure equivalent to the product of the Bergman fans of its minors.
\begin{lemma}\th\label{thm:starBijection}
    Let \( \bSigma_\cM \subseteq \bN_E \) be the Bergman fan of a matroid,
    and \( \sigma_\scrF \in \bSigma(k) \) be a cone with ray generators corresponding to the flag \( \scrF = \{F_1, \dots, F_k\} \).
    Then the star fan associated to \( \sigma_\scrF \) is isomorphic to the product fan of minors given by the intervals of \( \scrF \).
    That is to say
    \[
        \Star(\sigma_\scrF, \bSigma_\cM) \cong \prod_{i=1}^{k+1} \bSigma_{\cM_{[F_{i-1}, F_i]}}.
    \]
\end{lemma}
\begin{proof}
    Let \( \bSigma_\cM \subset \bN_E \) be the Bergman fan of a matroid,
    \[
        \scrF = \{ F_1 \subsetneq F_2 \subsetneq \cdots \subsetneq F_k \} \subseteq \cL^\ast
    \]
    be a flag of flats, and again define \( F_0 = \emptyset \) and \( F_{k+1} = E \).
    Take \( \phi \) to be the isomorphism given in \th\ref{thm:quotientBijection}.
    As per \th\ref{def:fanIsomorphism}, a fan isomorphism still requires an additional component, a bijective map
    \[
        \phi^\ast: \Star(\sigma_\scrF, \bSigma_\cM) \to \prod_{i=1}^{k+1} \bSigma_{\cM_{[F_{i-1}, F_i]}}
    \]
    between cones of the fan.
    We'll show that we can use \( \phi \) to induce this map between cones.
    Without loss of generality let us assume \( \sigma_\scrF \) is not a maximal cone, as 0-dimensional fans are trivially isomorphic.

    Consider a cone of the star fan \( \overline{\tau} \in \Star(\sigma_\scrF, \bSigma_\cM) \).
    From our definitions, we know that \( \overline{\tau} \) corresponds to some cone in the neighborhood of \( \sigma_\scrF \), \( \tau \in \nbd(\sigma_\scrF, \bSigma_\cM) \).
    Further then, we know that \( \tau \) is the face of some cone \( \pi \) such that \( \pi \in \bSigma_\cM(r) \) and \( \sigma_\scrF \preceq \tau \).
    Since \( \pi \) is a maximal cone, it must be associated to some complete flag \( \scrF' \), and since \( \sigma_\scrF \preceq \pi \) it must be that \( \scrF \subseteq \scrF' \).

    Let \( \scrF' = \{ F_1, \dots, F_k, G_1, \dots, G_\ell \} \), where \( G_i \in \cL^\ast \) and \( \{ F_1, \dots, F_k \} \cap \{ G_1, \dots, G_\ell \} = \emptyset \).
    As \( \tau \subseteq \pi \), we know that
    \[
        \tau = \cone( e_{F_{i_1}}, \dots, e_{F_{i_m}}, e_{G_{j_1}}, \dots,  e_{G_{j_n}}) \in \bN_E
    \]
    giving us
    \[
        \overline{\tau} = \cone([e_{G_{j_1}}], \dots,  [e_{G_{j_n}}]) \in \Star(\sigma_\scrF, \bSigma_\cM).
    \]
    Because flats are totally ordered, for each \( G_j \) there must be some {\( 1 \leq i \leq k+1 \)} such that
    \[
        F_{i-1} \subsetneq G_j \subsetneq F_{i}.
    \]
    Then for each \( G_j \) we have that
    \begin{align*}
        \phi([e_{G_j}]) & = 0 \oplus \cdots \oplus e_{G_j \cap (F_i \setminus F_{i-1})} \oplus \cdots \oplus 0 \\
                        & = e_{G_j \cap (F_i \setminus F_{i-1})}                                               \\
                        & = e_{G_j \setminus F_{i-1}},
    \end{align*}
    where \th\ref{thm:minorLattice} tells us that \( G_j \setminus F_{i-1} \) is a flat of the matroid minor \( \cM_{[F_{i-1}, F_i]} \) and so \( \phi([G_j]) \) is a ray in product fan.
    If we have the case
    \[
        F_{i-1} \subsetneq G_j \subsetneq  G_j' \subsetneq F_{i}
    \]
    then \( G_j \subsetneq  G_j' \) implies \(  G_j \setminus F_{i-1} \subsetneq  G_j' \setminus F_{i-1} \) and so
    \[
        \cone\big( \phi([e_{ G_j \setminus F_{i-1}}]), \phi([e_{G_j' \setminus F_{i-1}}]) \big) \in \bSigma_{\cM_{[F_{i-1}, F_i]}}.
    \]
    Otherwise, the cone between rays of different fans in the product are in the product fan by definition.
    This means that we have that
    \[
        \cone\big( \phi([e_{G_{j_1}}]), \dots,  \phi([e_{G_{j_n}}])\big)
    \]
    is an element of the product fan.

    Consider the map
    \begin{gather*}
        \phi^\ast = \Star(\sigma_\scrF, \bSigma_\cM) \to \prod_{i=1}^{k+1} \bSigma_{\cM_{[F_{i-1}, F_i]}} \\
        \phi^\ast\big(\cone\big([e_{G_{j_1}}], \dots,  [e_{G_{j_n}}])\big) = \cone\big( \phi([e_{G_{j_1}}]), \dots,  \phi([e_{G_{j_n}}])\big)
    \end{gather*}
    as our bijection between cones, given that we can write any cone in the star
    \[ \overline{\tau}  = \cone\big([e_{G_{j_1}}], \dots,  [e_{G_{j_n}}])\big) \]
    as above.
    Also from above, we see that \( \phi^\ast \) is injective, since \( \phi \) maps rays of the star uniquely to rays of the product.
    To confirm it is surjective, consider an arbitrary element
    \[
        (\tau_1, \dots, \tau_{k+1}) \in \prod_{i=1}^{k+1} \bSigma_{\cM_{[F_{i-1}, F_i]}}.
    \]
    Each \( \tau_i \) is a cone in \( \bSigma_{\cM_{[F_{i-1}, F_i]}} \) corresponding to a flag \( \{ G_{i,1} \subsetneq \dots \subsetneq G_{i,m} \} \) of \( \cM_{[F_{i-1}, F_i]} \).
    We can again use \th\ref{thm:minorLattice} which tells us that each \( G_{i,j} \cup F_{i-1} \) is a flat of \( \cM \).
    Further, since each \( G_{i, j} \cup F_{i-1} \) can be totally ordered with respect to both themselves and elements of \( \scrF \) they correspond to a flag.
    This flag, \( \scrF' \), contains \( \scrF \), and so the cone \( \tau_{\scrF'} \) is in the neighborhood of \( \sigma_\scrF \).
    From the work above we can then conclude that
    \[
        \phi^\ast(\overline{\tau}_{\scrF'}) = (\tau_1, \dots, \tau_m)
    \]
    giving us surjectivity.
    This gives us that \( \phi^\ast \) is a bijection of cones.

    The condition that for any cone \( \overline{\tau} \in \Star(\sigma_\scrF, \bSigma_\cM) \) the restriction \( \phi|_{\overline{\tau}} \) is a bijection between \( \overline{\tau} \) and \( \phi^\ast(\overline{\tau}) \) follows immediately from the definition of \( \phi^\ast \) and that \( \phi \) is already a bijection.
    We may conclude that our fans are isomorphic.
\end{proof}

\section{Bergman Fans of Matroids are AF}

With everything in the last section at our disposal, we may finally prove a key theorem.
\begin{theorem}\th\label{thm:matroidAF}
    For any matroid \( \cM \), its Bergman fan \( \bSigma_\cM \) is AF.
\end{theorem}

We need only show that the conditions of \th\ref{thm:suffAF} are met specifically for Bergman fans of matroids.
We'll tackle this one condition at a time, starting with the connectedness condition.

\begin{lemma}[Connectedness]\th\label{thm:matroidConnected}
    Let \( \bSigma_\cM \) be the Bergman fan of a matroid of rank \( r + 1 \).
    For every cone \( \sigma \in \bSigma_\cM(k) \), with \( k \leq r - 2 \),
    \[
        \Star(\tau, \bSigma_\cM) \setminus \{ 0 \}
    \]
    is connected.
\end{lemma}
\begin{proof}
    To prove this, it is sufficient to show that for any two rays in the fan, we may find a series of faces
    \[
        \rho_1 \prec \tau_1 \succ \rho_2 \prec \cdots \succ \rho_{k-1} \prec \tau_{k-1} \succ \rho_k
    \]
    where each \( \rho_i \) is a ray and each \( \tau_i \) is a 2-dimensional face.
    Since any point in a fan is connected to a ray, specifically one of the generating rays of the cone the point lives in, a path like this between arbitrary rays is enough to show our fan is connected without the origin.

    For some notational convenience, we will write
    \[
        \rho_1 \sim \tau_1 \sim \rho_2 \sim \cdots \sim \rho_{k-1} \sim \tau_{k-1} \sim \rho_k
    \]
    and let the reader interpret the correct face inclusions.
    Additionally, in keeping with our general convention, we'll write \( e_F \) for the ray generated by \( \sum_{i \in F} e_{\{i\}} \) and \( \tau_{F_1, F_2} \) for the cone generated by rays \( e_{F_1} \) and \( e_{F_2} \).
    Finally, we assume \( \cM \) is at least a rank 3 matroid, and so \( \bSigma_\cM \) has maximal cones of dimension at least 2, as otherwise the lemma is vacuously true.

    Now, we will consider this in two steps.
    First we'll look at \( \bSigma_\cM \setminus \{ 0 \} \) itself.
    Let \( e_{F}, e_{F'} \in \bSigma_\cM(1) \) be two arbitrary rays of our fan.
    If there exists some ground element \( i \in F \cap F' \), then we have the sequence
    \[
        e_F \sim \tau_{\{F, \{i\}\}} \sim e_{\{i\}} \sim \tau_{\{\{i\}, F'\}} \sim e_{F'}.
    \]
    Let us now consider that \( F \cap F' = \emptyset \).
    Let \( a \in F \) be an element of \( F \) and \( b \in F' \).
    To start, we have the sequence
    \[
        e_F \sim \tau_{\{F, \{a\}\}} \sim e_{\{a\}}.
    \]
    Now, recall the properties of the flats of a matroid, specifically property~\ref{def:F3}.
    This tells us that the flats of rank 2 partition \( E \setminus \{a\} \) and so there must be a rank 2 flat, \( \widehat{F} \), such that \( \{ a, b \} \subseteq \widehat{F} \).
    Then we have
    \[
        e_{\{a\}} \sim \tau_{\left\{\{a\}, \widehat{F}\right\}} \sim e_{\widehat{F}} \sim \tau_{\left\{\widehat{F}, b\right\}} \sim e_{\{b\}} \sim \tau_{\{\{b\}, F'\}} \sim e_{F'},
    \]
    showing a sequence from \( e_F \) to \( e_F' \), as desired.
    With that we have shown there is always a path along 2 dimensional faces between any two rays of the Bergman fan of a matroid, and so is connected even without the origin.

    Next, we'll turn to the stars of our matroid.
    Let \( k \leq r - 2 \) and \( \sigma_\scrF \in \bSigma_\cM(K) \) be a \( k \)-dimensional cone.
    We have that \( \Star( \sigma_\scrF, \bSigma_\cM) \) is a fan with maximal cones of dimension \( r - k \), which specifically means they are at least \( 2 \)-dimensional.
    From \th\ref{thm:starBijection}, we know that, given \( \scrF = \{ F_1 \subsetneq \cdots \subsetneq F_k \} \), we have that \( \Star( \sigma_\scrF, \bSigma_\cM) \) is in bijection with the product fan
    \[
        \prod_{i = 1}^{k+1} \bSigma_{\cM_{[F_{i-1}, F_i]}}.
    \]
    So, it is sufficient to show this product fan is connected after removing the origin.
    Recall that cones of the product fan are of the form
    \[
        (\sigma_1, \sigma_2, \dots, \sigma_k) \in \bSigma_{\cM_{[\emptyset, F_1]}} \times \bSigma_{\cM_{[F_{1}, F_2]}} \times \cdots \times \bSigma_{\cM_{[F_{k-1}, F_k]}} \times \bSigma_{\cM_{[F_{k}, E]}},
    \]
    and that the dimension of the cone \( (\sigma_1, \sigma_2, \dots, \sigma_k) \) is the sum of the dimensions of each cone \( \sigma_i \).
    Rays of the product fan are then of the form \( (0, 0, \dots, 0,  \rho, 0, \dots, 0) \) where \( \rho \) is a ray of the corresponding fan in the product.

    Now, to show our product fan is connected, we'll consider two cases.
    We will omit irrelevant zeros from our notation going forward for ease of reading, but we can add as many zeros in other positions as necessary without changing any part of the proof.
    In the first case, our two rays come from different fans in the product.
    If \( (\rho_1, 0) \) and \( (0, \rho_2) \) are rays, then there exists the path
    \[
        (\rho_1, 0) \sim (\rho_1, \rho_2) \sim (0, \rho_2)
    \]
    connecting them.
    The more nuanced case is if we have two rays from the same fan.

    Consider two rays \( \rho_1, \rho_2 \in \bSigma(1)\).
    If the minor that generates \( \bSigma \) is at least rank 3, then our work above shows there must exist a path between them using only the cones of \( \bSigma \).
    Where this breaks down, however, is if the minor has rank 2; i.e., the Bergman fan has only 1-dimensional cones.
    We can't, after removing the origin, get between rays solely within this fan.
    Recall though that our star fan must be pure of at least dimension 2.
    This means if this \(\bSigma \) has only 1-dimensional cones, then there is at least one other nonzero fan, which we'll call \( \bm{\Sigma'} \), in the product that has at least one ray.
    Let \( \eta \in  \bm{\Sigma'} \) be said ray.
    Then we have the path
    \[
        (\rho_1, 0) \sim (\rho_1, \eta) \sim (0, \eta) \sim (\rho_1, \eta) \sim (\rho_1, 0)
    \]
    connecting the two rays of \( \bSigma \).

    With this we've shown that any possible star of a Bergman fan of a matroid is connected without the origin.
\end{proof}

Next we may turn to the second criterion, that the quadratic form that determines the volume of the 2-dimensional faces of the normal complex corresponds to a matrix with exactly one positive eigenvalue.
For this, we will be using a classic result of linear algebra known as Sylvester's Lay of Inertia~\cite{sylvesterXIXDemonstrationTheorem1852}.
\begin{proposition}[Sylvester's Law of Inertia]\th\label{thm:sylvester}
    Two symmetric square matrices, \( A \) and \( B \), of the same size have the same number of positive, negative, and zero eigenvalues if and only if
    \[
        B = SAS^{T}
    \]
    for some non-singular matrix \( S \).
\end{proposition}
Our general strategy will be to first find the volume polynomials of star fans and then show that we can find an invertible change of basis that lets us express it as a sum of squares.
A quadratic form that consists only of squares corresponds to a diagonal matrix, so we can immediately read off the signs of the eigenvalues from the signs of the squared terms.
Sylvester's law of inertia then promises us that the signs of the eigenvalues are not particular to our choice of basis, rather invariant under any choice.
\begin{lemma}[Volume Quadratic Form Has One Positive Eigenvalue]\th\label{thm:matroidOnePosEigen}

    Let \( \cM \) be a matroid of rank \( r + 1 \) and \( \bSigma_\cM \) be the Bergman fan associated to the matroid, with \( \ast \in \Inn(\bN_E) \) an inner product.
    For every \( \sigma \in \bSigma_\cM(r - 2) \), the quadratic form associated to the volume polynomial of \( \Star(\sigma, \bSigma_\cM) \) has exactly one positive eigenvalue.

\end{lemma}
\begin{proof}
    Consider some \( \tau_\scrF \in \bSigma_\cM(r - 2) \), where \( \scrF = \{ F_1 \subsetneq \cdots \subsetneq F_{k} \} \).
    From the dimension reversing relationship of cones and their stars, we know that \( \Star(\tau_\scrF, \bSigma_\cM) \) is a \( 2 \)-fan.
    Once again using \th\ref{thm:starBijection}, we have that
    \[
        \Star(\tau_\scrF, \bSigma_\cM) \cong \prod_{i=0}^{r-2} \bSigma_{\cM_{[F_{i-1}, F_i]}}.
    \]
    Recall that \( F_{i-1} \) and \( F_i \) are adjacent to each other in the lattice of flats, \( \bSigma_{\cM_{[F_{i-1}, F_i]}} \) is just \( \{0\} \) and can be ignored as an element of the product.
    Since flags of \( \bSigma_\cM \) have \( r \) elements and \( |\scrF| = r - 2\), there are only two possible structures for our fan,
    either
    \[
        \bSigma_{\cM_{[F_{i-1}, F_i]}} \times \bSigma_{\cM_{[F_{j-1}, F_j]}}
        \quad \quad \text{or} \quad \quad
        \bSigma_{\cM_{[F_{i-1}, F_i]}}.
    \]
    Where in the first case the missing ranks of the flag are between two different pairs of flats and in the second the missing ranks are adjacent.
    We will split our proof into cases based on the two possible structures of our star fan.

    In the first case, let us assume that \( \Star(\tau_\scrF, \bSigma_\cM) = \bSigma \times \bSigma' \) where  \( \bSigma \) and  \( \bSigma' \) are both pure of dimension 1.
    This means that the \( 2 \)-dimensional cones in the product fan are exactly
    \[
        \{ \cone(\rho, \rho') \; | \; \rho \in \bSigma, \rho' \in \bSigma \}.
    \]
    The volume polynomial is given by
    \[
        \deg_{\bSigma \times \bSigma'}\big(D(z)^2\big) = \sum_{\mathclap{\rho_1, \rho_2 \in \bSigma \times \bSigma'(1)}} z_{\rho_1}z_{\rho_2} \deg_{\bSigma \times \bSigma'}(x_{\rho_1}x_{\rho_2}).
    \]
    Since each fan only has rank one flats there are no cones in the fan between rays of an individual fan.
    Conversely, in a product fan there is a cone between every pair of rays of different fans in the product.
    In our fairly simple case then, we see that this gives us
    \[
        \deg_{\bSigma \times \bSigma'}(x_{\rho_1}x_{\rho_2}) =
        \begin{cases}
            0 & \rho_1, \rho_2 \in \bSigma\; \text{or}\; \rho_1, \rho_2 \in \bSigma'                           \\
            1 & \rho_1 \in \bSigma, \rho_2 \in \bSigma'\; \text{or}\; \rho_2 \in \bSigma, \rho_1 \in \bSigma'.
        \end{cases}
    \]
    We may use this to get the volume polynomial as
    \[
        \sum_{\mathclap{\rho_1, \rho_2 \in \bSigma \times \bSigma'(1)}} z_{\rho_1}z_{\rho_2} \deg_{\bSigma \times \bSigma'}(x_{\rho_1}x_{\rho_2})
        = 2\sum_{\mathclap{\rho \in \bSigma, \rho' \in \bSigma'}} z_{\rho}z_{\rho'},
    \]
    accounting for the fact that \( z_{\rho}z_{\rho'} = z_{\rho'}z_{\rho} \).

    As per our strategy, we want to write this polynomial as a sum of squared terms.
    Some prodding will reveal that
    \[
        2\sum_{\mathclap{\rho \in \bSigma, \rho' \in \bSigma'}} z_{\rho}z_{\rho'}
        = \frac{1}{2} \left( \sum_{\rho \in \bSigma} z_\rho  + \sum_{\rho' \in \bSigma} z_\rho' \right)^2 - \frac{1}{2} \left( \sum_{\rho \in \bSigma} z_\rho  + \sum_{\rho' \in \bSigma} z_\rho' \right)^2
    \]
    is such a way to write the volume.
    The key idea is that in the expression
    \[
        -\left( \sum_{\rho \in \bSigma} z_\rho  + \sum_{\rho' \in \bSigma} z_\rho' \right)^2
    \]
    only terms of the form \( z_\rho z_{\rho'} \) are positive, with the rest going to cancel out the unwanted terms in the first expression.
    After adjusting for some slight over counting we see the polynomials agree.
    Since this is the sum of squared terms, we may read the signs of the eigenvalues of the associated matrix from the signs of the sums themselves, showing we have exactly one positive eigenvalue.
    By Sylvester's law of inertia then any matrix congruent to the one associated to the quadric form will have one positive eigenvalue, as desired.

    With the first case done, we have to turn to the second, when our face is the normal complex associated to a rank 3 minor.
    Let \( \bSigma = \Star(\tau, \bSigma_\cM)  \), and recall that as a the Bergman fan of a rank 3 matroid, \th\ref{thm:volRank3} gives us the volume polynomial as
    \[
        \deg_\bSigma(D(z)^2) =  2\sum_{\mathclap{\substack{F \subsetneq G \\ F,G \in \cL^\ast}}} z_F z_G - \sum_{\mathclap{\substack{G \in \cL^\ast \\ \rk(G)=2}}} z_G^2 - \sum_{\mathclap{\substack{F \in \cL^\ast \\ \rk(F)=1}}}(\cL^\sharp(F) - 1)z_F^2,
    \]
    where \( \cL^\sharp(F) \) is the number of minimal flats containing \( F \).
    We propose that we can write this instead as
    \[
        \deg_\bSigma(z) = \left( \sum_{\rk(F) = 1} z_F\right)^2 - \sum_{\substack{\rk(G) = 2}} \left( z_G - \sum_{\mathclap{\substack{F \subsetneq G }}} z_F\right)^2,
    \]
    which gives us the volume in terms of sums of squares.
    We again see this would have one positive eigenvalue.

    To see that these are equal, we will break this new expression down.
    First, we note that
    \begin{equation}
        \left( \sum_{\rk(F) = 1} z_F\right)^2 = \sum_{\rk(F) = 1} z_F^2 + 2\sum_{\mathclap{\substack{\rk(F_1) = 1, \\ \rk(F_2) = 1}}} z_{F_1}z_{F_2}.
    \end{equation}
    Then, let's look at the internal part of the second expression to see for a fixed rank 2 flat \( \hat{G} \) we have
    \begin{equation}
        \left( z_{\hat{G}} - \sum_{F \subsetneq {\hat{G}}} z_F \right)^2
        = z_{\hat{G}}^2 - 2\sum_{F \subsetneq \hat{G}} z_F z_{\hat{G}} + 2\sum_{\mathclap{F_1,F_2 \subsetneq \hat{G}}}z_{F_1} z_{F_2} + \sum_{F \subsetneq \hat{G}} z_F^2.
    \end{equation}
    What's important to note here is that if \( F_1, F_2 \subseteq G \), then there cannot be another rank 2 flat \( G' \) that contains both.
    This is a consequence of property~(\ref{def:F3}) of flats.
    But when we let the outer sum range over all possible rank 2 flats, we will get \( \cL^\sharp(F) \) copies of each \( z_F^2 \), and so we have
    \begin{equation}
        \sum_{\rk(G) = 2} \left( z_G - \sum_{F \subsetneq G} z_F\right)^2 =
        \sum_{\rk(G)=2}z_G^2
        - \sum_{F \subsetneq G}2 z_F z_{G}
        + 2\sum_{\substack{\rk(F_1) = 1, \\ \rk(F_2) = 1}}z_{F_1} z_{F_2}
        + \sum_{\rk(F) = 1} \cL^\sharp(F)z_F^2.
    \end{equation}
    If we subtract our result in (1.3) from the one in (1.1), we are left with
    \[
        2\sum_{\mathclap{\substack{F \subsetneq G \\ F,G \in \cL^\ast}}} z_F z_G - \sum_{\mathclap{\substack{G \in \cL^\ast \\ \rk(G)=2}}} z_G^2 - \sum_{\mathclap{\substack{F \in \cL^\ast \\ \rk(F)=1}}}(\cL^\sharp(F) - 1)z_F^2,
    \]
    recovering our original volume polynomial.
    We may again appeal to Sylvester's law of inertia to conclude that the matrix associated to the volume polynomial will have one positive eigenvalue.
    Having covered both cases we conclude that the \( 2 \)-stars of a Bergman fans of matroids have quadratic forms with one positive eigenvalue.

\end{proof}

With \th\ref{thm:matroidConnected} and \th\ref{thm:matroidOnePosEigen}, we see that Bergman fans of matroids will always satisfy the criteria of \th\ref{thm:suffAF}.

\section{Tying Up Loose Ends}

We now know that Bergman fans of matroids are AF, but this will only help us if we can find a pseudocubical value associated to the divisors \( \alpha \) and \( \beta \).
An immediate problem to address is that it could be that no cubical values exist at all.
Luckily, Proposition~7.4 of~\cite{nathansonTropicalFansNormal2023} gives us the following guarantee.
\begin{proposition}\th\label{thm:existCubical}
    Let \( \cM = (E, \cL) \) be a matroid with ground set \( E = \{ e_0, e_1, \dots, e_n \} \).
    Take \( \bSigma_\cM \) to be the Bergman fan of \( \cM \) in \( \bN_E \) such that we associate \( (e_1, e_2, \dots, e_n) \) to the standard basis vectors and \( \ast \) to be the standard inner product on this basis.
    Then
    \[
        \Cub(\bSigma_\cM, \ast) \neq \emptyset.
    \]
\end{proposition}

Going forward in this section, we'll take for granted that a matroid \( \cM = (E, \cL) \) has ground set \( E = \{ e_0, e_1, \dots, e_n \} \), and that \( \bSigma_\cM \subseteq \bN_E \) associates \( \{e_1, e_2, \dots, e_n\} \) to the standard basis vectors.
This makes \( e_0 \) our distinguished element, such that
\[
    e_0 = -\sum_{i=1}^n e_i.
\]
Additionally, we'll take \( \ast \) to be the standard inner product.
These assumptions allow us to invoke the above proposition.

Another important element from~\cite{nathansonTropicalFansNormal2023}, is that \( \pCub(\bSigma_\cM, \ast) \) is a cone in the space \( \R^{\bSigma_\cM(1)} \).
Specifically, purely cubical values are elements of the relative interior of this cone and pseudocubical values include elements on the boundary.
If \( \Cub(\bSigma_\cM, \ast) \) is non-empty then so is \( \pCub(\bSigma_\cM, \ast) \).
We now define the \( z \)-values associated to \( \alpha \) and \( \beta \) and show that they are indeed pseudocubical.

Recall that the definition of \( \alpha \) and \( \beta \) are independent of choice of ground element.
This means we're free to pick, and going forward we'll work with the assumption that
\[
    \alpha = \sum_{e_0 \in F} x_F \quad \text{and} \quad \beta = \sum_{e_0 \notin F} x_F.
\]
We stated that the divisor associated to a \( z \)-value is given by
\[
    D(z) = \sum_{\rho \in \bSigma_\cM} z_\rho x_\rho,
\]
but since our fan is the Bergman fan of a matroid, and rays are associated to flats, we may rephrase this as
\[
    D(z) = \sum_{F \in \cL^\ast} z_F x_F.
\]
We define \( z^\alpha = (z^\alpha_F \, | \, F \in \cL^\ast) \) and \( z^\beta = (z^\beta_F \, | \, F \in \cL^\ast) \) where
\[
    z^\alpha_F = \begin{cases}
        1 & e_0 \in F    \\
        0 & e_0 \notin F
    \end{cases}
    \quad \quad \text{and} \quad \quad
    z^\beta_F= \begin{cases}
        0 & e_0 \in F    \\
        1 & e_0 \notin F
    \end{cases}
\]
determines the components.
A quick inspection shows that \( D(z^\alpha) = \alpha \) and \( D(z^\beta) = \beta \) as desired.
Now we just need to show that \( z^\alpha \) and \( z^\beta \) are pseudocubical.
\begin{proposition}
    The \( z \)-values \(  z^\alpha \) and \( z^\beta \) lie in the pseudocubical cone:
    \[
        z^\alpha, z^\beta \in  \pCub(\bSigma_\cM, \ast).
    \]
\end{proposition}
\begin{proof}
    Let \( \bSigma_\cM \subseteq \bN_E \) be the Bergman fan of \( \cM \) and take \( \ast \) to be the standard inner product.
    To avoid confusion, let \( E = \{ e_0, e_1, \dots, e_n \} \) be the set of ground elements of \( \cM \) and \( \{ u_{e_1}, \dots, u_{e_n} \} \) to be the standard basis vectors of \( \bN_E \) associated to the ground elements.
    As usual, we'll write \( u_I = \sum_{i \in I} u_i \) and recall that \( u_{e_0} = -u_{e_1} - \cdots - u_{e_n} \).
    For any \( z \in \R^{\bSigma_{\cM}} \), we will define \( w_{\sigma}(z) \) to be the unique element in the intersection
    \[
        \Span(\sigma) \cap \left\{ v \in \bN_E \; \middle| \; v \ast u_F = z_F \, \text{for all flats \( F \) associated to rays in \( \sigma(1) \)} \right\}.
    \]
    That this intersection always yields a single element comes from the fact that our cones are simplicial.

    In order to prove that \( z^\alpha, z^\beta \in \R^{\bSigma_\cM(1)} \) are pseudocubical, we must show that for all cones \( \sigma \in \bSigma_\cM \),
    \[
        w_\sigma(z^\alpha) \in \sigma \quad \text{and} \quad w_\sigma(z^\beta) \in \sigma.
    \]

    Take \( \sigma_\scrF \in \bSigma_\cM \) to be an arbitrary cone and \( \scrF = \{ F_1 \subsetneq \cdots \subsetneq F_k \} \) to be its associated flag.
    We will prove that
    \begin{align*}
        w_{\sigma_\scrF}(z^\alpha) & = \begin{cases}
                                           \frac{1}{|F_k^\complement|}u_{F_k} & \quad e_0 \in F_k    \\
                                           0                                  & \quad e_0 \notin F_k
                                       \end{cases}
        \\
        w_{\sigma_\scrF}(z^\beta)  & = \begin{cases}
                                           0                      & \quad e_0 \in F_1    \\
                                           \frac{1}{|F_1|}u_{F_1} & \quad e_0 \notin F_1
                                       \end{cases}
    \end{align*}
    with \( F_k^\complement \) being the set compliment, \( F_k^\complement = E \setminus F_k \).
    Since these are in a ray of \( \sigma_\scrF \), they would of course be in \( \sigma_\scrF \).
    This is sufficient to show that \(  z^\alpha, z^\beta \in \pCub(\bSigma_\cM, \ast) \).

    Before we go on, we will need a fact about the inner product in our space.
    For subsets \( I \subseteq E \) and \( J \subseteq E \),
    \[
        u_{I} \ast u_{J} = \begin{cases}
            \phantom{-} | I \cap J |                         & e_0 \notin I \; \text{and} \; e_0 \notin J \\
            - | I \cap J^\complement |                       & e_0 \notin I \; \text{and} \; e_0 \in J    \\
            \phantom{-} | I^\complement \cap J^\complement | & e_0 \in I \; \text{and} \; e_0 \in J.
        \end{cases}
    \]
    The first case follows simply from the fact that the inner product multiplies the entries pairwise, and the \( 1 \) associated to \( u_{e_j} \) will only contribute to the sum if it's in both vectors.
    The second case follows from the fact that if \( e_0 \in J \),  \( u_J = - u_{E \setminus J} \), thanks to \( u_{e_0} \) being a vector with every entry set to \( -1 \).
    The final case follows from the previous two, and that \( (-1) \cdot (-1) = 1 \).

    We'll start with \( w_{\sigma_\scrF}(z^\alpha) \).
    Since it is uniquely characterized by the condition
    \[
        w_{\sigma_\scrF}(z^\alpha) \ast u_{F_j} = z^\alpha_{F_j}
    \]
    for all \( 1 \leq j \leq k \), we just need to show that this equality holds.
    First, let's assume that \( e_0 \in F_k \).
    Then
    \begin{align*}
        w_{\sigma_\scrF}(z^\alpha) \ast u_{F_j} & = {\frac{1}{|F_k^\complement|}}u_{F_k} \ast u_{F_j}    \\
                                                & = {\frac{1}{|F_k^\complement|}}(u_{F_k} \ast u_{F_j}),
    \end{align*}
    thanks to inner products being bilinear.
    From above, we know
    \[
        u_{F_k} \ast u_{F_j} = \begin{cases}
            |F_k^\complement \cap F_j|             & e_0 \notin F_j \\
            |F_k^\complement \cap F_j^\complement| & e_0 \in F_j
        \end{cases}
    \]
    and since \( F_j \subseteq F_k \) we can see that
    \[
        u_{F_k} \ast u_{F_j} = \begin{cases}
            0                 & e_0 \notin F_j \\
            |F_k^\complement| & e_0 \in F_j
        \end{cases}
    \]
    by some elementary set theory.
    And so when we incorperate back in our scalar, we get
    \[
        w_{\sigma_\scrF}(z^\alpha) \ast u_{F_j} = \begin{cases}
            0 & e_0 \notin F_j \\
            1 & e_0 \in F_j
        \end{cases}
    \]
    which matches the value of \( z^\alpha_{F_j} \).
    Turning to the other case, let's assume that \( e_0 \notin F_k \).
    Then by definition, \( z^\alpha_{F_j} = 0 \) for all \( 1 \leq j \leq k \), and since \( 0 \ast u_{F_j} = 0 \) we again have
    \[
        w_{\sigma_\scrF}(z^\alpha) \ast u_{F_j} = z^\alpha_j.
    \]
    We conclude then that \( w_{\sigma_\scrF}(z^\alpha) \) is in the cone \( \sigma_\scrF \), and so \( z^alpha \) is pseudocubical.

    The proof that \(  w_z^\beta \) is pseudocubical follows analogously.
    We want to show that
    \begin{align*}
        w_{\sigma_\scrF}(z^\beta) \ast u_{F_j} = z^\beta_{F_j}
    \end{align*}
    for all \( 1 \leq j \leq k \).
    This time we start with the case that \( e_0 \notin F_1 \).
    Then as defined, we have
    \[
        w_{\sigma_\scrF}(z^\beta) \ast u_{F_j} = {\frac{1}{|F_k|}}(u_{F_k} \ast u_{F_j}).
    \]
    Using some set theory we get
    \[
        u_{F_1} \ast u_{F_j} =
        \begin{cases}
            |F_1 \cap F_j| = |F_1|         & e_0 \notin F_j \\
            |F_1 \cap F_j^\complement| = 0 & e_0 \in F_j
        \end{cases}
    \]
    and so
    \[
        w_{\sigma_\scrF}(z^\beta) \ast u_{F_j} = \begin{cases}
            1 & e_0 \notin F_j \\
            0 & e_0 \in F_j
        \end{cases}
    \]
    again matching how we have defined the component \( z^\beta_{F_j} \).
    On the other hand, if \( e_0 \in F_1 \), then \( z^\beta_{F_j} = 0 \) for each \( 1 \leq j \leq k \).
    Since \( w_{\sigma_\scrF}(z^\beta) = 0 \) this again works just fine.

    With that we've shown that both \( z^\alpha \) and \( z^\beta \) are pseudocubical values in \( \pCub(\bSigma_\cM, \ast) \).
\end{proof}

Finally, we have one last problem to address.
From the proof above we can see that \(  z^\alpha, z^\beta \notin \Cub(\bSigma_\cM, \ast) \).
They are on the boundary of \( \pCub(\bSigma_\cM, \ast) \), however the definition of AF fans, \th\ref{def:AF}, is only for strictly cubical \( z \)-values.
We turn, in desperation, to a bit of analysis to help us here.
\begin{lemma}\th\label{thm:cubeLimit}
    Let \( \bSigma \subseteq \bN \) be a fan and \( \ast \in \inn(\bN_E) \) an inner product such that \( \Cub( \bSigma, \ast) \) is nonempty.
    Then for any \( z \in \pCub(\bSigma, \ast) \), there exists values \( z_t \in \Cub(\bSigma_\cM, \ast) \), \( t \in (0, 1] \), such that
    \[
        \lim_{t \to 0} z_t = z.
    \]
\end{lemma}
\begin{proof}
    This actually follows from convex geometry.
    Take any \( z \in \pCub( \bSigma, \ast) \), and recall that \(  \pCub( \bSigma, \ast) \) is a cone in \( \R^{\bSigma(1)} \).
    Since we've assumed \( \Cub( \bSigma, \ast) \) is nonempty, let \( z_1 \in \Cub( \bSigma, \ast) \) be a point in the interior of the cone.
    Then define
    \[
        z_t = t z_1 + (1 - t)z.
    \]
    Then \( \lim_{t \to 0} z_t = z \) and when \( t \) is restricted to the interval \( [0,1] \) this is just the convex hull of \( z \) and \( z_1 \).
    Since this line segment must be contained in the cone and \( z_1 \) is in the interior, all points must be in the interior except maybe \( z \).
    Thus for all \( t \in (0,1) \) we have \( z_t \in \Cub( \bSigma, \ast) \).
\end{proof}
This allows us to approximate any pseudocubical value using only cubical values.
We now, truly, have everything we need to get to prove our final theorem.

\section{Putting It All Together}

\begin{Result}
    For any matroid \( \cM \), the Heron-Rota-Welsh conjecture is true.
\end{Result}
\begin{proof}
    Let \( \cM = (E, \cL) \) be a matroid with ground set \( E = \{ e_0, e_1, \dots, e_n \} \).
    Take \( \bSigma_\cM \subseteq \bN_E \) to be the Bergman fan of \( \cM \) and associate \( (e_1, e_2, \dots, e_n) \) to the standard basis vectors and choose \( \ast \in \inn(\bN_E) \) to be the standard inner product on this basis.

    By \th\ref{thm:coeffIsDeg}, we know that the reduced characteristic coefficients of \( \cM \) can be associated to mixed degrees of divisors under the degree map,
    \[
        \ow_k = \deg(\alpha^{r-k}\beta^k).
    \]
    And by \th\ref{thm:mixedDeg}, we have that
    \[
        \MVol_{\bSigma, \ast}(z_1, \dots, z_d) = \deg\big( D(z_1) \cdots D(z_d) \big).
    \]
    So, by using the \( z \)-values defined in the previous section, we can identify reduced characteristic coefficients with mixed volumes of normal complexes, given by
    \[
        \ow_k = \MVol_{\Sigma, \ast}(\underbrace{z^\alpha,\ldots,z^\alpha}_{r-k},\underbrace{z^\beta,\ldots,z^\beta}_{k}).
    \]

    By \th\ref{thm:existCubical} we know that \( \Cub(\bSigma, \ast) \) is non-empty, and so we may use \th\ref{thm:cubeLimit} to get sequences of cubical values \( z_t^\alpha \) and \( z_t^\beta \) such that
    \[
        \lim_{t \to 0 } z_t^\alpha = z^\alpha \quad \text{and} \quad  \lim_{t \to 0 } z_t^\beta = z^\beta.
    \]
    Define
    \[
        \ow_{k,t} = \MVol_{\Sigma, \ast}(\underbrace{z_t^\alpha,\ldots,z_t^\alpha}_{r-k},\underbrace{z_t^\beta,\ldots,z_t^\beta}_{k})
    \]
    which means \( \lim_{t \to 0} \ow_{k,t} = \ow_k \).
    Because \( z_t^\alpha, z_t^\beta \in \Cub(\bSigma_\cM, \ast) \) and \( \bSigma_\cM \) is AF by \th\ref{thm:matroidAF}, we have that
    \[
        \MVol_{\Sigma, \ast}(\underbrace{z_t^\alpha,\mydots,z_t^\alpha}_{r-k},\underbrace{z_t^\beta,\mydots,z_t^\beta}_{k})^2
        \geq
        \MVol_{\Sigma, \ast}(\underbrace{z_t^\alpha,\mydots,z_t^\alpha}_{r-k-1},\underbrace{z_t^\beta,\mydots,z_t^\beta}_{k-1})
        \MVol_{\Sigma, \ast}(\underbrace{z_t^\alpha,\mydots,z_t^\alpha}_{r-k+1},\underbrace{z_t^\beta,\mydots,z_t^\beta}_{k+1})
    \]
    for \( 1 < k < r \), as per \th\ref{def:AF}, which in turn means
    \[
        \ow_{k,t}^2 \geq \ow_{k-1,t}\ow_{k+1,t}.
    \]
    Since \( \MVol_{\Sigma, \ast} \) is always non-negative, this makes the sequence \( \{ \ow_{1,t}, \dots, \ow_{k-1,t}  \} \) log-concave for any \( t \in (0,1] \).
    This implies that under the limit as \( t \to 0 \) we have that \( \{ \ow_{1}, \dots, \ow_{k-1} \} \) is a log-concave sequence.
    As the reduced characteristic coefficients are log-concave, \th\ref{thm:reducedImpliesOriginal} tells us we may conclude that the Whitney numbers of the first kind are log-concave, proving the Heron-Rota-Welsh conjecture.

\end{proof}

\end{document}